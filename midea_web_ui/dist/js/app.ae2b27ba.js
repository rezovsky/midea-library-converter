(function(){"use strict";var e={1292:function(e,t,n){var i=n(5130),a=n(6768);function r(e,t,n,i,r,l){const o=(0,a.g2)("MainPage");return(0,a.uX)(),(0,a.Wv)(o)}const l={class:"main-content"};function o(e,t,n,i,r,o){const s=(0,a.g2)("MediaTabs"),d=(0,a.g2)("el-col"),u=(0,a.g2)("el-row"),f=(0,a.g2)("el-container");return(0,a.uX)(),(0,a.Wv)(f,{style:{height:"100vh",display:"flex"}},{default:(0,a.k6)((()=>[(0,a.Lk)("div",l,[(0,a.bF)(u,{justify:"center"},{default:(0,a.k6)((()=>[(0,a.bF)(d,{span:12},{default:(0,a.k6)((()=>[(0,a.bF)(s,{media_paths:r.media_paths,files:r.files},null,8,["media_paths","files"])])),_:1})])),_:1})])])),_:1})}function s(e,t,n,i,r,l){const o=(0,a.g2)("el-header"),s=(0,a.g2)("FileItem"),d=(0,a.g2)("el-main"),u=(0,a.g2)("el-container"),f=(0,a.g2)("el-tab-pane"),c=(0,a.g2)("el-tabs");return(0,a.uX)(),(0,a.Wv)(c,{modelValue:r.activeTab,"onUpdate:modelValue":t[0]||(t[0]=e=>r.activeTab=e)},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.media_paths,((e,n)=>((0,a.uX)(),(0,a.Wv)(f,{key:n,label:e.split("/").pop(),name:e},{default:(0,a.k6)((()=>[r.encode_files.length>0?((0,a.uX)(),(0,a.Wv)(u,{key:0},{default:(0,a.k6)((()=>[(0,a.bF)(o,{style:{height:"20px"}},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("Кодируется")]))),_:1}),(0,a.bF)(d,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.encode_files,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t},[(0,a.bF)(s,{file:e},null,8,["file"])])))),128))])),_:2},1024)])),_:2},1024)):(0,a.Q3)("",!0),r.added_files.length>0?((0,a.uX)(),(0,a.Wv)(u,{key:1},{default:(0,a.k6)((()=>[(0,a.bF)(o,{style:{height:"20px"}},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("В очереди")]))),_:1}),(0,a.bF)(d,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.added_files,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t},[(0,a.bF)(s,{file:e},null,8,["file"])])))),128))])),_:2},1024)])),_:2},1024)):(0,a.Q3)("",!0),r.encoded_files.length>0?((0,a.uX)(),(0,a.Wv)(u,{key:2},{default:(0,a.k6)((()=>[(0,a.bF)(o,{style:{height:"20px"}},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("Завершено")]))),_:1}),(0,a.bF)(d,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.encoded_files,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t},[(0,a.bF)(s,{file:e},null,8,["file"])])))),128))])),_:2},1024)])),_:2},1024)):(0,a.Q3)("",!0)])),_:2},1032,["label","name"])))),128))])),_:1},8,["modelValue"])}var d=n(4232);const u={class:"file-content",style:{padding:"0px"}},f={key:1};function c(e,t,n,i,r,l){const o=(0,a.g2)("el-progress"),s=(0,a.g2)("el-card");return(0,a.uX)(),(0,a.Wv)(s,{class:"file-card",style:(0,d.Tr)(l.cardStyle),shadow:"hover"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",u,[(0,a.Lk)("h4",null,(0,d.v_)(l.fileName),1),n.file.frames>0&&"encode"===n.file.status?((0,a.uX)(),(0,a.Wv)(o,{key:0,percentage:l.progress,"text-inside":!0,"stroke-width":18},null,8,["percentage"])):(0,a.Q3)("",!0),l.formattedDuration?((0,a.uX)(),(0,a.CE)("p",f,"Длительность: "+(0,d.v_)(l.formattedDuration),1)):(0,a.Q3)("",!0)])])),_:1},8,["style"])}var h={name:"FileItem",props:{file:{type:Object,required:!0}},computed:{cardStyle(){switch(this.file.status){case"encode":return"background-color: #d9ecff; border-color: #a0cfff;";case"added":return"background-color: #faecd8; border-color: #f3d19e;";case"encoded":return"background-color: #e1f3d8; border-color: #b3e19d;";default:return"background-color: #e9e9eb; border-color: #c8c9cc;"}},fileName(){return this.file.path.split("/").pop()},progress(){return Math.round(this.file.frame/this.file.frames*100)},formattedDuration(){if(0===this.file.duration)return null;const e=Math.floor(this.file.duration/3600),t=Math.floor(this.file.duration%3600/60),n=this.file.duration%60;let i="";return e>0&&(i+=`${e}ч `),(t>0||e>0)&&(i+=`${t}м `),i+=`${n}с`,i.trim()}}},p=n(1241);const b=(0,p.A)(h,[["render",c],["__scopeId","data-v-1bccceb4"]]);var m=b,v={name:"MediaTabs",components:{FileItem:m},props:{files:{type:Array,required:!0},media_paths:{type:Array,required:!0}},data(){return{added_files:[],encode_files:[],encoded_files:[],activeTab:""}},mounted(){this.media_paths.length>0&&(this.activeTab=this.media_paths[0]),this.filterFiles()},methods:{filterFiles(){this.added_files=this.files.filter((e=>"added"===e.status)),this.encode_files=this.files.filter((e=>"encode"===e.status)),this.encoded_files=this.files.filter((e=>"encoded"===e.status))}},watch:{files:{handler(){this.filterFiles()},immediate:!0,deep:!0},media_paths:{handler(e){e.length>0&&!this.activeTab&&(this.activeTab=e[0])},immediate:!0}}};const g=(0,p.A)(v,[["render",s]]);var _=g,y={name:"MainPage",components:{MediaTabs:_},data(){return{files:[],media_paths:[],intervalId:null}},methods:{fetchData(){this.$axios.get("/db/files").then((e=>{this.files=e.data})).catch((e=>{console.error("Ошибка при получении файлов:",e)}))},getMediaPaths(){this.$axios.get("/db/paths").then((e=>{this.media_paths=e.data.map((e=>e.path)),console.log("media paths: ",this.media_paths)})).catch((e=>{console.error("Ошибка при получении путей:",e)}))}},mounted(){this.getMediaPaths(),this.fetchData(),this.intervalId=setInterval(this.fetchData,5e3)}};const k=(0,p.A)(y,[["render",o]]);var F=k,X={name:"App",components:{MainPage:F}};const w=(0,p.A)(X,[["render",r]]);var x=w,M=n(4373),O=n(6762);n(4188);const T=(0,i.Ef)(x);T.config.globalProperties.$axios=M.A,M.A.defaults.baseURL="http://docker.r41:8000/",T.use(O.A),T.mount("#app")}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,i,a,r){if(!i){var l=1/0;for(u=0;u<e.length;u++){i=e[u][0],a=e[u][1],r=e[u][2];for(var o=!0,s=0;s<i.length;s++)(!1&r||l>=r)&&Object.keys(n.O).every((function(e){return n.O[e](i[s])}))?i.splice(s--,1):(o=!1,r<l&&(l=r));if(o){e.splice(u--,1);var d=a();void 0!==d&&(t=d)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[i,a,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var a,r,l=i[0],o=i[1],s=i[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(s)var u=s(n)}for(t&&t(i);d<l.length;d++)r=l[d],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},i=self["webpackChunkmidea_web_ui"]=self["webpackChunkmidea_web_ui"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[504],(function(){return n(1292)}));i=n.O(i)})();
//# sourceMappingURL=app.ae2b27ba.js.map